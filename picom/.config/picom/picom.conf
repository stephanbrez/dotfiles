# general
mark-wmwin-focused = true;
mark-ovredir-focused = true;

# backend
backend = "glx";
experimental-backends = true;
vsync = true;
glx-no-stencil = true;
paint-on-overlay = true;

# logging
log-level = "debug";
log-file = "/home/stephan/.local/share/picom/picom.log";

# corners
corner-radius = 6;

# shadows
shadow = false;
shadow-opacity = 0.3;
shadow-radius = 7;
shadow-offset-x = -7;
shadow-offset-y = -7;

# fading
fading = true;
fade-in-step = 0.03;
fade-out-step = 0.03;
fade-delta = 5;

# animations (fixed syntax)
animations = (
  {
    triggers = [ "close", "hide" ];
    preset = "disappear";
  },
  {
    triggers = [ "open", "show" ];
    preset = "appear";
  }
);

# blur (global defaults; per-rule overrides below)
# blur: {
#   method = "dual_kawase";
#   strength = 4;
# };
# blur-background = true;
# blur-background-fixed = true;

# window rules (rules-only; no old-style opacity-rule / blur-background-exclude)
rules = (
  # Never blur these (put FIRST)
  {
    match = "window_type = 'dock' || window_type = 'desktop' || window_type = 'menu' || window_type = 'popup_menu' || window_type = 'dropdown_menu'";
    opacity = 1.0;
  },

  # Focused: no blur
  { match = "focused || group_focused"; opacity = 1.0; blur-background = false; },

  # Unfocused: blur ON (NO blur-method/blur-strength here)
  {
    match = "!focused && !group_focused";
    opacity = 0.9;
  }
);
